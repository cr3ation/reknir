<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <title>Resultatrapport - {{ company.name }}</title>
    <style>
        @page {
            size: A4;
            margin: 1.5cm 1.5cm 2cm 1.5cm;
            @top-right {
                content: "";
            }
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 7.5pt;
            line-height: 1.4;
            color: #222;
        }

        /* === HEADER === */
        .header-grid {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0;
        }

        .header-left {
            flex: 1;
        }

        .company-name {
            font-size: 9pt;
            font-weight: bold;
        }

        .company-org {
            font-size: 7.5pt;
            color: #444;
            margin-top: 1px;
        }

        .header-center {
            text-align: center;
            flex: 1;
        }

        .report-title {
            font-size: 13pt;
            font-weight: bold;
            color: #0066cc;
        }

        .report-subtitle {
            font-size: 8pt;
            color: #444;
            margin-top: 2px;
        }

        .header-right {
            flex: 1;
            font-size: 7.5pt;
            color: #444;
        }

        .header-right table {
            margin-left: auto;
        }

        .header-right td:first-child {
            padding-right: 12px;
        }

        .header-right td:last-child {
            text-align: right;
        }

        .page-current::after {
            content: counter(page);
        }

        .page-total::after {
            content: counter(pages);
        }

        .report-info {
            font-size: 7.5pt;
            color: #444;
            margin: 8px 0 14px 0;
        }

        .report-info td:first-child {
            padding-right: 12px;
        }

        /* === TABLE === */
        table.report-table {
            width: 100%;
            border-collapse: collapse;
        }

        /* Column headers */
        table.report-table th {
            text-align: right;
            font-size: 7.5pt;
            font-weight: bold;
            padding: 4px 0;
            color: #0066cc;
            border-bottom: 2px solid #0066cc;
        }

        table.report-table th:first-child {
            text-align: left;
        }

        table.report-table th.col-amount {
            width: 15%;
        }

        /* --- Section headers (Rörelsens intäkter mm) --- */
        tr.section-header td {
            font-weight: bold;
            font-size: 8.5pt;
            padding: 10px 0 2px 0;
            border: none;
            color: #0066cc;
        }

        /* --- Group headers (Nettoomsättning) --- */
        tr.group-header td {
            font-weight: bold;
            font-size: 7.5pt;
            padding: 4px 0 1px 16px;
            border: none;
        }

        /* --- Account rows --- */
        tr.account-row td {
            padding: 1px 0;
            border: none;
            font-size: 7.5pt;
        }

        tr.account-row td:first-child {
            padding-left: 32px;
        }

        .account-number {
            font-family: 'Courier New', monospace;
            font-size: 7pt;
            color: #666;
            display: inline-block;
            width: 34px;
        }

        td.amount {
            text-align: right;
            font-family: 'Courier New', monospace;
            font-size: 7.5pt;
            white-space: nowrap;
        }

        /* --- Group sum (S:a Nettoomsättning) --- */
        tr.group-sum td {
            padding: 1px 0 4px 32px;
            border-top: 1px solid #999;
            font-size: 7.5pt;
        }

        tr.group-sum td.amount {
            padding-left: 0;
        }

        /* --- Section sum (S:a Rörelseintäkter mm) --- */
        tr.section-sum td {
            padding: 2px 0 3px 16px;
            border-top: 1px solid #4a90c4;
            font-weight: bold;
            font-size: 7.5pt;
        }

        tr.section-sum td.amount {
            padding-left: 0;
        }

        /* --- Intermediate result (Bruttovinst, Rörelseresultat...) --- */
        tr.intermediate td {
            padding: 3px 0 3px 0;
            border-top: 2px solid #0066cc;
            font-weight: bold;
            font-size: 7.5pt;
            color: #0066cc;
        }

        /* --- Final result (Beräknat resultat) --- */
        tr.final-result td {
            padding: 6px 0 3px 0;
            font-weight: bold;
            font-size: 8.5pt;
            border-top: 2px solid #0066cc;
            border-bottom: 2px solid #0066cc;
            color: #0066cc;
        }

        /* Spacer row */
        tr.spacer td {
            padding: 3px 0;
            border: none;
        }

        /* === FOOTER === */
        .footer {
            margin-top: 16px;
            padding-top: 6px;
            border-top: 1px solid #ddd;
            font-size: 6.5pt;
            color: #666;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header-grid">
        <div class="header-left">
            <div class="company-name">{{ company.name }}</div>
            <div class="company-org">{{ company.org_number }}</div>
        </div>
        <div class="header-center">
            <div class="report-title">Resultatrapport</div>
            <div class="report-subtitle">Preliminär</div>
        </div>
        <div class="header-right">
            <table>
                <tr><td>Sida:</td><td><span class="page-current"></span>(<span class="page-total"></span>)</td></tr>
                <tr><td>Utskrivet:</td><td>{{ generated_date }}</td></tr>
            </table>
        </div>
    </div>

    <div class="report-info">
        <table>
            <tr><td>Räkenskapsår:</td><td>{{ period_start }} – {{ period_end }}</td></tr>
            <tr><td>Period:</td><td>{{ period_start }} – {{ period_end }}</td></tr>
        </table>
    </div>

    <!-- Income statement table -->
    <table class="report-table">
        <thead>
            <tr>
                <th></th>
                <th class="col-amount">Perioden</th>
                <th class="col-amount">Ackumulerat</th>
                <th class="col-amount">Period fg år</th>
            </tr>
        </thead>
        <tbody>
            {% for row in data.rows %}

            {% if row.type == 'section_header' %}
            <tr class="section-header">
                <td colspan="4">{{ row.title }}</td>
            </tr>

            {% elif row.type == 'group_header' %}
            <tr class="group-header">
                <td colspan="4">{{ row.title }}</td>
            </tr>

            {% elif row.type == 'account' %}
            <tr class="account-row">
                <td>
                    <span class="account-number">{{ row.account_number }}</span>
                    {{ row.name }}
                </td>
                <td class="amount">{{ row.period|format_sek }}</td>
                <td class="amount">{{ row.accumulated|format_sek }}</td>
                <td class="amount">{{ row.prev_year|format_sek }}</td>
            </tr>

            {% elif row.type == 'group_sum' %}
            <tr class="group-sum">
                <td>{{ row.title }}</td>
                <td class="amount">{{ row.period|format_sek }}</td>
                <td class="amount">{{ row.accumulated|format_sek }}</td>
                <td class="amount">{{ row.prev_year|format_sek }}</td>
            </tr>

            {% elif row.type == 'section_sum' %}
            <tr class="section-sum">
                <td>{{ row.title }}</td>
                <td class="amount">{{ row.period|format_sek }}</td>
                <td class="amount">{{ row.accumulated|format_sek }}</td>
                <td class="amount">{{ row.prev_year|format_sek }}</td>
            </tr>

            {% elif row.type == 'intermediate' %}
            <tr class="intermediate">
                <td>{{ row.title }}</td>
                <td class="amount">{{ row.period|format_sek }}</td>
                <td class="amount">{{ row.accumulated|format_sek }}</td>
                <td class="amount">{{ row.prev_year|format_sek }}</td>
            </tr>

            {% elif row.type == 'final_result' %}
            <tr class="final-result">
                <td>{{ row.title }}</td>
                <td class="amount">{{ row.period|format_sek }}</td>
                <td class="amount">{{ row.accumulated|format_sek }}</td>
                <td class="amount">{{ row.prev_year|format_sek }}</td>
            </tr>

            {% elif row.type == 'separator' %}
            <tr class="spacer"><td colspan="4"></td></tr>

            {% endif %}
            {% endfor %}
        </tbody>
    </table>

    <!-- Footer -->
    <div class="footer">
        {{ company.name }} | Org.nr: {{ company.org_number }}
        {% if company.is_vat_registered %} | Momsreg: {{ company.vat_number }}{% endif %}
    </div>
</body>
</html>
